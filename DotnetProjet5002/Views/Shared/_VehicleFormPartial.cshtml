@model DotnetProjet5.ViewModels.VehicleViewModel

<div class="container">
    <div class="row">
        <div class="col-12 col-md-6 mx-auto">

            <input asp-for="VehicleId" type="hidden" />

            <div class="form-group">
                <label asp-for="CodeVin" class="control-label"></label>
                <input asp-for="CodeVin" class="form-control" aria-describedby="codeVinHelp codeVinError" aria-invalid="true" />
                <span id="codeVinHelp" class="form-text text-muted">Entrez le code VIN du véhicule.</span>
                <span id="codeVinError" asp-validation-for="CodeVin" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="Year" class="control-label"></label>
                <input asp-for="Year" class="form-control" type="number" value="1990" min="1990" max="@DateTime.Now.Year" aria-describedby="yearHelp yearError" aria-invalid="true" />
                <span id="yearHelp" class="form-text text-muted">Entrez l'année de fabrication du véhicule.</span>
                <span id="yearError" asp-validation-for="Year" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="PurchaseDate" class="control-label"></label>
                <input asp-for="PurchaseDate" class="form-control" type="date" aria-describedby="purchaseDateHelp purchaseDateError" min="1990-01-01" max="@DateTime.Now.ToString("yyyy-MM-dd")" onkeydown="return false;" aria-invalid="true" />
                <span id="purchaseDateHelp" class="form-text text-muted">Entrez la date d'achat du véhicule.</span>
                <span id="purchaseDateError" asp-validation-for="PurchaseDate" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="PurchasePrice" class="control-label"></label>
                <input asp-for="PurchasePrice" class="form-control" aria-describedby="purchasePriceHelp purchasePriceError" aria-invalid="true" />
                <span id="purchasePriceHelp" class="form-text text-muted">Entrez le prix d'achat du véhicule.</span>
                <span id="purchasePriceError" asp-validation-for="PurchasePrice" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="Brand" class="control-label"></label>
                <input asp-for="Brand" class="form-control" aria-describedby="brandHelp brandError" aria-invalid="true" />
                <span id="brandHelp" class="form-text text-muted">Entrez la marque du véhicule.</span>
                <span id="brandError" asp-validation-for="Brand" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="Model" class="control-label"></label>
                <input asp-for="Model" class="form-control" aria-describedby="modelHelp modelError" aria-invalid="true" />
                <span id="modelHelp" class="form-text text-muted">Entrez le modèle du véhicule.</span>
                <span id="modelError" asp-validation-for="Model" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="Finish" class="control-label"></label>
                <input asp-for="Finish" class="form-control" aria-describedby="finishHelp finishError" aria-invalid="true" />
                <span id="finishHelp" class="form-text text-muted">Entrez la finition du véhicule.</span>
                <span id="finishError" asp-validation-for="Finish" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group">
                <label asp-for="Description" class="control-label"></label>
                <input asp-for="Description" class="form-control" aria-describedby="descriptionHelp descriptionError" aria-invalid="true" />
                <span id="descriptionHelp" class="form-text text-muted">Entrez une description du véhicule.</span>
                <span id="descriptionError" asp-validation-for="Description" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group mb-2">
                <label asp-for="AvailabilityDate" class="control-label"></label>
                <input asp-for="AvailabilityDate" class="form-control" type="date" aria-describedby="availabilityDateHelp availabilityDateError" aria-invalid="true" />
                <span id="availabilityDateHelp" class="form-text text-muted">Entrez la date de disponibilité du véhicule.</span>
                <span id="availabilityDateError" asp-validation-for="AvailabilityDate" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group mb-2">
                <label asp-for="Availability" class="control-label"></label>
                <input asp-for="Availability" type="checkbox" aria-describedby="availabilityHelp availabilityError" aria-invalid="true" />
                <span id="availabilityHelp" class="form-text text-muted">Cochez si le véhicule est disponible.</span>
                <span id="availabilityError" asp-validation-for="Availability" class="text-danger" role="alert"></span>
            </div>
            <div class="form-group mb-2">
                <label asp-for="Selled" class="control-label"></label>
                <input asp-for="Selled" type="checkbox" aria-describedby="selledHelp selledError" aria-invalid="true" />
                <span id="selledHelp" class="form-text text-muted">Cochez si le véhicule est vendu.</span>
                <span id="selledError" asp-validation-for="Selled" class="text-danger" role="alert"></span>
            </div>


            <div class="form-group mb-5">
                <label asp-for="ImageFile" class="control-label"></label>
                <div class="input-group">
                    <label for="file-upload" class="file-button-custom flex flex-row align-content-center justify-content-center">
                        <div class="btn btn-outline-dark m-2 justify-content-center align-content-center" style="height:64px; width:64px;">
                            <i class="fa-solid fa-plus fa-2xl"></i>
                        </div>
                        <div class="text-muted">Ajoutez une image</div>
                    </label>
                    <input id="file-upload" asp-for="ImageFile" type="file" class="d-none" aria-describedby="imageFileHelp imageFileError" aria-invalid="true" />
                </div>
                <span id="file-name" class="form-text text-muted mt-2"></span> <!-- Element to display the file name -->
                <span id="imageFileError" asp-validation-for="ImageFile" class="text-danger" role="alert"></span>
            </div>

            
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var input = document.getElementById('file-upload');
        var fileNameElement = document.getElementById('file-name');
        var imageFileError = document.getElementById('imageFileError');
        var form = document.querySelector('form');

        if (input) {
            input.addEventListener('change', function () {
                if (input.files.length > 0) {
                    var file = input.files[0];
                    var validImageTypes = ['image/jpeg', 'image/png', 'image/gif'];

                    if (validImageTypes.includes(file.type)) {
                        fileNameElement.textContent = file.name;
                        imageFileError.textContent = ''; // Clear any previous error message
                    } else {
                        fileNameElement.textContent = '';
                        imageFileError.textContent = 'Veuillez sélectionner un fichier image valide (JPEG, PNG, GIF).';
                    }
                }
            });
        } else {
            console.error("File input element not found.");
        }

        form.addEventListener('submit', function (event) {
            if (input.files.length > 0) {
                var file = input.files[0];
                var validImageTypes = ['image/jpeg', 'image/png', 'image/gif'];

                if (!validImageTypes.includes(file.type)) {
                    event.preventDefault();
                    imageFileError.textContent = 'Veuillez sélectionner un fichier image valide (JPEG, PNG, GIF).';
                }
            }
        });
    });
</script>
